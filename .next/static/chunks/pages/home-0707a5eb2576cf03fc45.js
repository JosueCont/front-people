_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[13],{LrPk:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return n("rmSC")}])},rmSC:function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),c=n.n(a),s=n("HaE+"),r=n("nKUr"),o=n("ODXe"),i=n("Ol7k"),l=n("Vl3Y"),d=n("tsqr"),j=n("Tckk"),u=n("Sdc0"),m=n("jsC+"),h=n("2/Rp"),b=n("BvKs"),f=n("BMrR"),p=n("bE4q"),x=n("kPKH"),O=n("5rEg"),g=n("2fM7"),v=n("wCAj"),y=n("kLXV"),w=n("+KLJ"),k=n("vDqi"),_=n.n(k),C=n("OcYQ"),I=n("q1tI"),E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},F=n("6VBw"),S=function(e,t){return I.createElement(F.a,Object.assign({},e,{ref:t,icon:E}))};S.displayName="EllipsisOutlined";var z=I.forwardRef(S),M=n("xvlK"),N={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},T=function(e,t){return I.createElement(F.a,Object.assign({},e,{ref:t,icon:N}))};T.displayName="SearchOutlined";var D=I.forwardRef(T),P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},A=function(e,t){return I.createElement(F.a,Object.assign({},e,{ref:t,icon:P}))};A.displayName="DownloadOutlined";var L=I.forwardRef(A),R=n("z7Xi"),q=n("Cgje"),B=(n("LvDl"),n("+eQT")),U=n("zeV3"),V=function(e){var t=l.a.useForm(),n=Object(o.a)(t,1)[0],a=Object(I.useState)([]),j=a[0],u=a[1],m=Object(I.useState)([]),b=m[0],p=m[1],v=Object(I.useState)([]),w=v[0],k=v[1],E=Object(I.useState)(""),F=E[0],S=E[1],z=Object(I.useState)(""),M=z[0],N=z[1];Object(I.useEffect)((function(){T("5f417a53c37f6275fb614104")}),[]);var T=function(){var e=Object(s.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={"client-id":"5f417a53c37f6275fb614104","Content-Type":"application/json"},_.a.get("https://khonnect.hiumanlab.com/group/list/",{headers:n}).then((function(e){if(200===e.status){var t=e.data.data;t=t.map((function(e){return{label:e.name,value:e.id}})),u(t)}})).catch((function(e){console.log(e)})),_.a.get(C.a+"/person/person-type/").then((function(e){if(200===e.status){var t=e.data.results;t=t.map((function(e){return{label:e.name,value:e.id}})),p(t)}})).catch((function(e){console.log(e)})),_.a.get(C.a+"/business/department/").then((function(e){if(200===e.status){var t=e.data.results;t=t.map((function(e){return{label:e.name,value:e.id}})),N(t)}})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(t){_.a.post(C.a+"/person/person/",t).then((function(t){d.b.success("Agregado correctamente"),n.resetFields(),e.close(!1)})).catch((function(e){d.b.error("Error al agregar, intente de nuevo")}))};var P=function(){e.close(!1),n.resetFields()},A={required:!0,message:"Este campo es requerido"};return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(i.a,{children:Object(r.jsx)(y.a,{maskClosable:!1,title:"Alta de personas",centered:!0,visible:e.visible,onCancel:function(){return P()},footer:null,width:"60%",children:Object(r.jsx)(l.a,{onFinish:function(e){""!==F&&(e.birth_date=F),D(e)},form:n,children:Object(r.jsxs)(f.a,{children:[Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{name:"person_type",children:Object(r.jsx)(g.a,{options:b,placeholder:"Tipo de persona"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{name:"department",children:Object(r.jsx)(g.a,{options:M,onChange:function(e){_.a.get(C.a+"/business/department/".concat(e,"/job_for_department/")).then((function(e){if(200===e.status){var t=e.data;t=t.map((function(e){return{label:e.name,value:e.id}})),k(t)}})).catch((function(e){console.log(e)}))},placeholder:"Departamento"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{name:"job",children:Object(r.jsx)(g.a,{options:w,placeholder:"Puesto de trabajo"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{rules:[A],name:"first_name",children:Object(r.jsx)(O.a,{type:"text",placeholder:"Nombre"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{rules:[A],name:"flast_name",children:Object(r.jsx)(O.a,{type:"text",placeholder:"Apellido paterno"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{name:"mlast_name",children:Object(r.jsx)(O.a,{type:"text",placeholder:"Apellido materno"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{name:"gender",children:Object(r.jsx)(g.a,{options:[{label:"Maculino",value:1},{label:"Femenino",value:2},{label:"Otro",value:3}],placeholder:"G\xe9nero"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{children:Object(r.jsx)(B.a,{style:{width:"100%"},onChange:function(e,t){S(t)},moment:"YYYY-MM-DD",placeholder:"Fecha de nacimiento"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{rules:[{type:"email",message:"Ingrese un correo electronico valido"},A],name:"email",children:Object(r.jsx)(O.a,{type:"email",placeholder:"E-mail"})})}),Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{rules:[A],name:"password",children:Object(r.jsx)(O.a.Password,{type:"text",placeholder:"Contrase\xf1a"})})}),Object(r.jsx)(x.a,{lg:15,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{name:"groups",children:Object(r.jsx)(g.a,{mode:"multiple",options:j,showArrow:!0,style:{width:"100%"},placeholder:"Permisos"})})}),Object(r.jsx)(x.a,{lg:22,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{labelAlign:"right",children:Object(r.jsxs)(U.b,{style:{float:"right"},children:[Object(r.jsx)(h.a,{type:"danger",onClick:function(){return P()},children:"Cancelar"}),Object(r.jsx)(h.a,{type:"primary",htmlType:"submit",children:"Guardar"})]})})})]})})})})})},Y=n("YFqc"),H=n.n(Y),K=i.a.Content;t.default=function(){var e=Object(I.useState)([]),t=e[0],n=e[1],a=Object(I.useState)(!1),k=a[0],E=a[1],F=Object(I.useState)(!0),S=F[0],N=F[1],T=Object(I.useState)(!1),P=T[0],A=T[1],B=l.a.useForm(),U=Object(o.a)(B,1)[0],Y=Object(I.useRef)(null),X={},G=Object(I.useState)("https://khorplus.s3.amazonaws.com/demo/people/person/images/photo-profile/1412021224859/placeholder-profile-sq.jpg"),J=G[0],W=(G[1],Object(I.useState)(!1)),Q=W[0],$=W[1],Z=Object(I.useState)(""),ee=Z[0],te=Z[1],ne=Object(I.useState)([]),ae=ne[0],ce=ne[1];Object(I.useEffect)((function(){se()}),[]);var se=function(e){E(!0),void 0==e?_.a.get(C.a+"/person/person/").then((function(e){e.data.results.map((function(e){e.key=e.id,e.fullname=e.first_name+" "+e.flast_name+" "+e.mlast_name,e.timestamp=e.timestamp.substring(0,10),e.photo||(e.photo=J)})),n(e.data.results),E(!1)})).catch((function(e){console.log(e)})):_.a.post(C.a+"/person/person/get_list_persons/ ",X).then((function(e){e.data.map((function(e){e.key=e.id,e.fullname=e.first_name+" "+e.flast_name+" "+e.mlast_name,e.timestamp=e.timestamp.substring(0,10),e.photo||(e.photo=J)})),n(e.data),E(!1)})).catch((function(e){n([]),E(!1),console.log(e)}))},re=function(e){A(e),E(!0),_.a.get(C.a+"/person/person/").then((function(e){e.data.results.map((function(e){e.key=e.id,e.fullname=e.first_name+" "+e.flast_name+" "+e.mlast_name,e.timestamp=e.timestamp.substring(0,10),e.photo||(e.photo=J)})),n(e.data.results),E(!1)})).catch((function(e){console.log(e),E(!1)}))},oe={background:"#434343",color:"#ffff"},ie=[{title:"Foto",render:function(e){return Object(r.jsx)("div",{children:Object(r.jsx)(j.a,{src:e.photo})})}},{title:"Nombre",dataIndex:"fullname",key:"fullname"},{title:"Estatus",render:function(e){return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(u.a,{defaultChecked:e.is_active,checkedChildren:"Activo",unCheckedChildren:"Inactivo"})})}},{title:"Fecha de registro",dataIndex:"timestamp",key:"timestamp"},{title:"RFC",dataIndex:"rfc",key:"rfc"},{title:"IMSS",dataIndex:"imss",key:"imss"},{title:function(){return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(m.a,{overlay:de,children:Object(r.jsx)(h.a,{style:oe,size:"small",children:Object(r.jsx)(z,{})})})})},render:function(e){return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(m.a,{overlay:function(){return je(e)},children:Object(r.jsx)(h.a,{style:{background:"#8c8c8c",color:"withe"},size:"small",children:Object(r.jsx)(z,{})})})})}}],le={onChange:function(e,t){ce(t)}},de=Object(r.jsx)(b.a,{children:Object(r.jsx)(b.a.Item,{onClick:function(){return ue(ae)},children:"Eliminar"})}),je=function(e){return Object(r.jsxs)(b.a,{children:[Object(r.jsx)(b.a.Item,{children:Object(r.jsx)(H.a,{href:"/home/".concat(e.id),children:"Editar"})}),Object(r.jsx)(b.a.Item,{onClick:function(){return ue([e])},children:"Eliminar"})]})},ue=function(e){if(e.length>0){ce(e);var t=null;e.map((function(e){t=t?t+","+e.id:e.id})),te(t),he()}else d.b.error("Selecciona una persona.")},me=function(e){var t=e.personsDelete;return Object(r.jsx)("div",{children:t.map((function(e){return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(f.a,{children:[Object(r.jsx)(j.a,{src:e.photo}),Object(r.jsx)("span",{children:" "+e.first_name+" "+e.flast_name})]})})}))})},he=function(){$(!Q)},be=function(){var e=Object(s.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"csv"==fe(t.target.files[0].name)?((n=new FormData).append("File",t.target.files[0]),E(!0),_.a.post(C.a+"/person/import-export-person",n).then((function(e){E(!1),d.b.success("Excel importado correctamente."),se()})).catch((function(e){E(!1),d.b.error("Error al importar."),console.log(e)}))):d.b.error("Formato incorrecto, suba un archivo .csv");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(e){return/[.]/.exec(e)?/[^.]+$/.exec(e)[0]:void 0};return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(i.a,{children:[Object(r.jsx)(q.a,{}),Object(r.jsxs)(K,{className:"site-layout",style:{padding:"0 50px",marginTop:64},children:[Object(r.jsxs)(p.a,{style:{margin:"16px 0"},children:[Object(r.jsx)(p.a.Item,{children:"Home"}),Object(r.jsx)(p.a.Item,{children:"Person"})]}),Object(r.jsx)("div",{style:{padding:"1%",float:"right"},children:Object(r.jsxs)(h.a,{style:{background:"#fa8c16",fontWeight:"bold",color:"white"},onClick:function(){return re(!0)},children:[Object(r.jsx)(M.a,{}),"Agregar persona"]})}),Object(r.jsxs)("div",{className:"site-layout-background",style:{padding:24,minHeight:380,height:"100%"},children:[Object(r.jsxs)("div",{style:{padding:24},children:[Object(r.jsx)(l.a,{onFinish:function(e){void 0!==e.name&&""!==e.name&&(X.first_name=e.name),void 0!==e.gender&&(X.gender=e.gender),void 0!==S&&(X.is_active=0==S?0:1),se("filter")},layout:"vertical",form:U,children:Object(r.jsxs)(f.a,{children:[Object(r.jsx)(x.a,{lg:7,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{name:"name",children:Object(r.jsx)(O.a,{placeholder:"Nombre"})})}),Object(r.jsx)(x.a,{lg:4,xs:22,offset:1,children:Object(r.jsx)(l.a.Item,{name:"gender",children:Object(r.jsx)(g.a,{options:[{label:"Maculino",value:1},{label:"Femenino",value:2},{label:"Otro",value:3}],placeholder:"G\xe9nero"})})}),Object(r.jsx)(x.a,{lg:3,xs:5,offset:1,children:Object(r.jsxs)(l.a.Item,{name:"is_active",children:[Object(r.jsx)("label",{children:Object(r.jsx)("span",{style:{fontWeight:"bold"},children:"Activos:"})}),Object(r.jsx)(u.a,{style:{marginLeft:"10%"},defaultChecked:!0,onChange:function(){N(!S)}})]})}),Object(r.jsx)(x.a,{lg:2,xs:5,offset:1,children:Object(r.jsx)(l.a.Item,{children:Object(r.jsx)(h.a,{icon:Object(r.jsx)(D,{}),type:"primary",htmlType:"submit",children:"Buscar"})})})]})}),Object(r.jsx)("div",{children:Object(r.jsxs)(f.a,{children:[Object(r.jsx)(h.a,{style:{margin:"20px"},type:"primary",icon:Object(r.jsx)(L,{}),size:{size:"large"},onClick:function(){return E(!0),void _.a.get(C.a+"/person/import-export-person/csv").then((function(e){var t=e.headers["content-type"],n=new Blob([e.data],{type:t,encoding:"UTF-8"}),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download="Personas.csv",a.click(),E(!1)})).catch((function(e){E(!1),console.log(e)}))},children:"Descargar resultados"}),Object(r.jsx)(h.a,{style:{margin:"20px"},icon:Object(r.jsx)(R.a,{}),onClick:function(){Y.current.click()},children:"Importar personas"}),Object(r.jsx)("input",{ref:Y,type:"file",style:{display:"none"},onChange:function(e){return be(e)}}),Object(r.jsx)(h.a,{style:{margin:"20px"},type:"primary",icon:Object(r.jsx)(L,{}),size:{size:"large"},onClick:function(){return E(!0),void _.a.get(C.a+"/person/import-export-person/plantilla").then((function(e){var t=e.headers["content-type"],n=new Blob([e.data],{type:t,encoding:"UTF-8"}),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download="PlantillaPersonas.csv",a.click(),E(!1)})).catch((function(e){E(!1),console.log(e)}))},children:"Descargar plantilla"})]})})]}),Object(r.jsx)(v.a,{size:"small",columns:ie,dataSource:t,loading:k,rowSelection:le})]})]}),Object(r.jsx)(V,{close:re,visible:P}),Object(r.jsxs)(y.a,{title:"Modal",visible:Q,onOk:function(){_.a.post(C.a+"/person/person/delete_by_ids/",{persons_id:ee}).then((function(e){he(),se(),E(!1),d.b.success("Eliminado correctamente.")})).catch((function(e){E(!1),console.log(e)}))},onCancel:he,okText:"Si, Eliminar",cancelText:"Cancelar",children:[Object(r.jsx)(w.a,{message:"Warning",description:"Al eliminar este registro perder\xe1 todos los datos relacionados a el de manera permanente. \xbfEst\xe1 seguro de querer eliminarlo?",type:"warning",showIcon:!0}),Object(r.jsx)(me,{personsDelete:ae})]})]})})}}},[["LrPk",0,2,5,7,1,3,4,6]]]);