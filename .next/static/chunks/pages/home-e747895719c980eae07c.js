_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[43],{LrPk:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return n("rmSC")}])},Sdc0:function(e,t,n){"use strict";var a=n("wx14"),c=n("rePB"),r=n("q1tI"),o=n("ODXe"),s=n("Ff2n"),i=n("TSYQ"),l=n.n(i),d=n("6cGi"),u=n("4IlW"),j=r.forwardRef((function(e,t){var n,a=e.prefixCls,i=void 0===a?"rc-switch":a,j=e.className,h=e.checked,f=e.defaultChecked,b=e.disabled,m=e.loadingIcon,p=e.checkedChildren,O=e.unCheckedChildren,x=e.onClick,g=e.onChange,v=e.onKeyDown,y=Object(s.a)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),w=Object(d.a)(!1,{value:h,defaultValue:f}),k=Object(o.a)(w,2),C=k[0],_=k[1];function E(e,t){var n=C;return b||(_(n=e),null===g||void 0===g||g(n,t)),n}var I=l()(i,j,(n={},Object(c.a)(n,"".concat(i,"-checked"),C),Object(c.a)(n,"".concat(i,"-disabled"),b),n));return r.createElement("button",Object.assign({},y,{type:"button",role:"switch","aria-checked":C,disabled:b,className:I,ref:t,onKeyDown:function(e){e.which===u.a.LEFT?E(!1,e):e.which===u.a.RIGHT&&E(!0,e),null===v||void 0===v||v(e)},onClick:function(e){var t=E(!C,e);null===x||void 0===x||x(t,e)}}),m,r.createElement("span",{className:"".concat(i,"-inner")},C?p:O))}));j.displayName="Switch";var h=j,f=n("ye1Q"),b=n("g0mS"),m=n("H84U"),p=n("3Nzz"),O=n("uaoM"),x=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(e);c<a.length;c++)t.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(e,a[c])&&(n[a[c]]=e[a[c]])}return n},g=r.forwardRef((function(e,t){var n,o=e.prefixCls,s=e.size,i=e.loading,d=e.className,u=void 0===d?"":d,j=e.disabled,g=x(e,["prefixCls","size","loading","className","disabled"]);Object(O.a)("checked"in g||!("value"in g),"Switch","`value` is not a valid prop, do you mean `checked`?");var v=r.useContext(m.b),y=v.getPrefixCls,w=v.direction,k=r.useContext(p.b),C=y("switch",o),_=r.createElement("div",{className:"".concat(C,"-handle")},i&&r.createElement(f.a,{className:"".concat(C,"-loading-icon")})),E=l()((n={},Object(c.a)(n,"".concat(C,"-small"),"small"===(s||k)),Object(c.a)(n,"".concat(C,"-loading"),i),Object(c.a)(n,"".concat(C,"-rtl"),"rtl"===w),n),u);return r.createElement(b.a,{insertExtraNode:!0},r.createElement(h,Object(a.a)({},g,{prefixCls:C,className:E,disabled:j||i,ref:t,loadingIcon:_})))}));g.__ANT_SWITCH=!0,g.displayName="Switch";t.a=g},rmSC:function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),c=n.n(a),r=n("HaE+"),o=n("ODXe"),s=n("nKUr"),i=n("Ol7k"),l=n("Vl3Y"),d=n("tsqr"),u=n("Tckk"),j=n("Sdc0"),h=n("jsC+"),f=n("2/Rp"),b=n("BvKs"),m=n("BMrR"),p=n("bE4q"),O=n("kPKH"),x=n("5rEg"),g=n("2fM7"),v=n("wCAj"),y=n("kLXV"),w=n("vDqi"),k=n.n(w),C=n("OcYQ"),_=n("q1tI"),E=n("GZ0F"),I=n("l+S1"),S=n("xvlK"),N={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},F=n("6VBw"),z=function(e,t){return _.createElement(F.a,Object.assign({},e,{ref:t,icon:N}))};z.displayName="DownloadOutlined";var T=_.forwardRef(z),P=n("z7Xi"),D=n("foez"),R=(n("LvDl"),n("+eQT")),V=n("zeV3"),A=function(e){var t=l.a.useForm(),n=Object(o.a)(t,1)[0],a=Object(_.useState)([]),u=a[0],j=a[1],h=Object(_.useState)([]),b=h[0],p=h[1],v=Object(_.useState)([]),w=v[0],E=v[1],I=Object(_.useState)(""),S=I[0],N=I[1],F=Object(_.useState)(""),z=F[0],T=F[1];Object(_.useEffect)((function(){P("5f417a53c37f6275fb614104")}),[]);var P=function(){var e=Object(r.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={"client-id":"5f417a53c37f6275fb614104","Content-Type":"application/json"},k.a.get("https://khonnect.hiumanlab.com/group/list/",{headers:n}).then((function(e){if(200===e.status){var t=e.data.data;t=t.map((function(e){return{label:e.name,value:e.id}})),j(t)}})).catch((function(e){console.log(e)})),k.a.get(C.a+"/person/person-type/").then((function(e){if(200===e.status){var t=e.data.results;t=t.map((function(e){return{label:e.name,value:e.id}})),p(t)}})).catch((function(e){console.log(e)})),k.a.get(C.a+"/business/department/").then((function(e){if(200===e.status){var t=e.data.results;t=t.map((function(e){return{label:e.name,value:e.id}})),T(t)}})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(t){k.a.post(C.a+"/person/person/",t).then((function(t){d.b.success("Agregado correctamente"),n.resetFields(),e.close(!1)})).catch((function(e){d.b.error("Error al agregar, intente de nuevo")}))};var A=function(){e.close(!1),n.resetFields()},M={required:!0,message:"Este campo es requerido"};return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(i.a,{children:Object(s.jsx)(y.a,{maskClosable:!1,title:"Alta de personas",centered:!0,visible:e.visible,onCancel:function(){return A()},footer:null,width:"60%",children:Object(s.jsx)(l.a,{onFinish:function(e){""!==S&&(e.birth_date=S),D(e)},form:n,children:Object(s.jsxs)(m.a,{children:[Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{name:"person_type",children:Object(s.jsx)(g.a,{options:b,placeholder:"Tipo de persona"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{name:"department",children:Object(s.jsx)(g.a,{options:z,onChange:function(e){k.a.get(C.a+"/business/department/".concat(e,"/job_for_department/")).then((function(e){if(200===e.status){var t=e.data;t=t.map((function(e){return{label:e.name,value:e.id}})),E(t)}})).catch((function(e){console.log(e)}))},placeholder:"Departamento"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{name:"job",children:Object(s.jsx)(g.a,{options:w,placeholder:"Puesto de trabajo"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{rules:[M],name:"first_name",children:Object(s.jsx)(x.a,{type:"text",placeholder:"Nombre"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{rules:[M],name:"flast_name",children:Object(s.jsx)(x.a,{type:"text",placeholder:"Apellido paterno"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{name:"mlast_name",children:Object(s.jsx)(x.a,{type:"text",placeholder:"Apellido materno"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{name:"gender",children:Object(s.jsx)(g.a,{options:[{label:"Masculino",value:1},{label:"Femenino",value:2},{label:"Otro",value:3}],placeholder:"G\xe9nero"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{children:Object(s.jsx)(R.a,{style:{width:"100%"},onChange:function(e,t){N(t)},moment:"YYYY-MM-DD",placeholder:"Fecha de nacimiento"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{rules:[{type:"email",message:"Ingrese un correo electronico valido"},M],name:"email",children:Object(s.jsx)(x.a,{type:"email",placeholder:"E-mail"})})}),Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{rules:[M],name:"password",children:Object(s.jsx)(x.a.Password,{type:"text",placeholder:"Contrase\xf1a"})})}),Object(s.jsx)(O.a,{lg:15,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{name:"groups",children:Object(s.jsx)(g.a,{mode:"multiple",options:u,showArrow:!0,style:{width:"100%"},placeholder:"Permisos"})})}),Object(s.jsx)(O.a,{lg:22,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{labelAlign:"right",children:Object(s.jsxs)(V.b,{style:{float:"right"},children:[Object(s.jsx)(f.a,{onClick:function(){return A()},children:"Cancelar"}),Object(s.jsx)(f.a,{type:"primary",htmlType:"submit",children:"Guardar"})]})})})]})})})})})},M=n("YFqc"),q=n.n(M);i.a.Content,t.default=function(){var e=Object(_.useState)([]),t=e[0],n=e[1],a=Object(_.useState)(!1),i=a[0],w=a[1],N=Object(_.useState)(!0),F=N[0],z=N[1],R=Object(_.useState)(!1),V=R[0],M=R[1],L=l.a.useForm(),B=Object(o.a)(L,1)[0],H=Object(_.useRef)(null),U={},K=Object(_.useState)("https://khorplus.s3.amazonaws.com/demo/people/person/images/photo-profile/1412021224859/placeholder-profile-sq.jpg"),Y=K[0],X=(K[1],Object(_.useState)(!1)),G=X[0],Q=X[1],W=Object(_.useState)(""),J=W[0],Z=W[1],$=Object(_.useState)([]),ee=$[0],te=$[1],ne=Object(_.useState)(null),ae=ne[0],ce=ne[1];Object(_.useEffect)((function(){re()}),[]);var re=function(e){w(!0),void 0==e?k.a.get(C.a+"/person/person/").then((function(e){e.data.results.map((function(e,t){e.key=t,e.photo||(e.photo=Y)})),n(e.data.results),w(!1)})).catch((function(e){console.log(e)})):k.a.post(C.a+"/person/person/get_list_persons/ ",U).then((function(e){e.data.map((function(e){e.photo||(e.photo=Y)})),n(e.data),w(!1)})).catch((function(e){n([]),w(!1),console.log(e)}))},oe=function(e){M(e),w(!0),k.a.get(C.a+"/person/person/").then((function(e){e.data.results.map((function(e){e.key=e.id,e.fullname=e.first_name+" "+e.flast_name+" "+e.mlast_name,e.timestamp=e.timestamp.substring(0,10),e.photo||(e.photo=Y)})),n(e.data.results),w(!1)})).catch((function(e){console.log(e),w(!1)}))},se={background:"#434343",color:"#ffff"},ie=[{title:"Foto",render:function(e){return Object(s.jsx)("div",{children:Object(s.jsx)(u.a,{src:e.photo})})}},{title:"Nombre",render:function(e){var t=e.first_name+" "+e.flast_name;return e.mlast_name&&(t=t+" "+e.mlast_name),Object(s.jsx)("div",{children:t})}},{title:"Estatus",render:function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(j.a,{defaultChecked:e.is_active,checkedChildren:"Activo",unCheckedChildren:"Inactivo",onChange:function(){return de(e)}})})}},{title:"Fecha de ingreso",render:function(e){return Object(s.jsx)("div",{children:e.date_of_admission})}},{title:"RFC",dataIndex:"rfc",key:"rfc"},{title:"IMSS",dataIndex:"imss",key:"imss"},{title:function(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(h.a,{overlay:ue,children:Object(s.jsx)(f.a,{style:se,size:"small",children:Object(s.jsx)(E.a,{})})})})},render:function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(h.a,{overlay:function(){return je(e)},children:Object(s.jsx)(f.a,{style:{background:"#8c8c8c",color:"withe"},size:"small",children:Object(s.jsx)(E.a,{})})})})}}],le={onChange:function(e,t){te(t)}},de=function(e){e.is_active?e.is_active=!1:e.is_active=!0,delete e.photo,k.a.put(C.a+"/person/person/".concat(e.id,"/"),e).then((function(n){n.data.photo||(n.data.photo=Y),n.data.key=e.key,t.map((function(e){e.id==n.data.id&&(e=n.data)}))})).catch((function(e){console.log(e)}))},ue=Object(s.jsx)(b.a,{children:Object(s.jsx)(b.a.Item,{onClick:function(){return he(ee)},children:"Eliminar"})}),je=function(e){return Object(s.jsxs)(b.a,{children:[Object(s.jsx)(b.a.Item,{children:Object(s.jsx)(q.a,{href:"/home/".concat(e.id),children:"Editar"})}),Object(s.jsx)(b.a.Item,{onClick:function(){return he([e])},children:"Eliminar"})]})};Object(_.useEffect)((function(){console.log(ee)}),[ee]);var he=function(){var e=Object(r.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),ce("Eliminar usuarios "),t.length>0?(1==t.length&&ce("Eliminar usuario "+t[0].first_name+" "+t[0].flast_name),te(t),console.log(ee),n=null,t.map((function(e){n=n?n+","+e.id:e.id})),Z(n),fe()):d.b.error("Selecciona una persona.");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){Q(!G)},be=function(){var e=Object(r.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"csv"==me(t.target.files[0].name)?((n=new FormData).append("File",t.target.files[0]),w(!0),k.a.post(C.a+"/person/import-export-person",n).then((function(e){w(!1),d.b.success("Excel importado correctamente."),re()})).catch((function(e){w(!1),d.b.error("Error al importar."),console.log(e)}))):d.b.error("Formato incorrecto, suba un archivo .csv");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(e){return/[.]/.exec(e)?/[^.]+$/.exec(e)[0]:void 0};return Object(s.jsxs)(D.a,{currentKey:"1",children:[Object(s.jsxs)(p.a,{children:[Object(s.jsx)(p.a.Item,{children:"Inicio"}),Object(s.jsx)(p.a.Item,{children:"Personas"})]}),Object(s.jsxs)("div",{className:"container",style:{width:"100%"},children:[Object(s.jsxs)(m.a,{justify:"space-between",className:"formFilter",children:[Object(s.jsx)(O.a,{xs:24,sm:24,md:20,lg:20,xl:20,children:Object(s.jsx)(l.a,{onFinish:function(e){void 0!==e.name&&""!==e.name&&(U.first_name=e.name),void 0!==e.gender&&(U.gender=e.gender),void 0!==F&&(U.is_active=0==F?0:1),re("filter")},layout:"vertical",form:B,children:Object(s.jsxs)(m.a,{children:[Object(s.jsx)(O.a,{lg:7,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{name:"name",children:Object(s.jsx)(x.a,{placeholder:"Nombre"})})}),Object(s.jsx)(O.a,{lg:4,xs:22,offset:1,children:Object(s.jsx)(l.a.Item,{name:"gender",children:Object(s.jsx)(g.a,{options:[{label:"Masculino",value:1},{label:"Femenino",value:2},{label:"Otro",value:3}],placeholder:"G\xe9nero"})})}),Object(s.jsx)(O.a,{lg:3,xs:5,offset:1,children:Object(s.jsxs)(l.a.Item,{name:"is_active",children:[Object(s.jsx)("label",{children:Object(s.jsx)("span",{style:{fontWeight:"bold"},children:"Activos:"})}),Object(s.jsx)(j.a,{style:{marginLeft:"10%"},defaultChecked:!0,onChange:function(){z(!F)}})]})}),Object(s.jsx)(O.a,{lg:2,xs:5,offset:1,children:Object(s.jsx)(l.a.Item,{children:Object(s.jsx)(f.a,{icon:Object(s.jsx)(I.a,{}),type:"primary",htmlType:"submit",children:"Buscar"})})})]})})}),Object(s.jsx)(O.a,{children:Object(s.jsxs)(f.a,{style:{background:"#fa8c16",fontWeight:"bold",color:"white"},onClick:function(){return oe(!0)},children:[Object(s.jsx)(S.a,{}),"Agregar persona"]})})]}),Object(s.jsx)(m.a,{justify:"end",children:Object(s.jsxs)(O.a,{children:[Object(s.jsx)(f.a,{className:"ml-20",type:"primary",icon:Object(s.jsx)(T,{}),size:{size:"large"},onClick:function(){return w(!0),void k.a.get(C.a+"/person/import-export-person/csv").then((function(e){var t=e.headers["content-type"],n=new Blob([e.data],{type:t,encoding:"UTF-8"}),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download="Personas.csv",a.click(),w(!1)})).catch((function(e){w(!1),console.log(e)}))},children:"Descargar resultados"}),Object(s.jsx)(f.a,{className:"ml-20",icon:Object(s.jsx)(P.a,{}),onClick:function(){H.current.click()},children:"Importar personas"}),Object(s.jsx)("input",{ref:H,type:"file",style:{display:"none"},onChange:function(e){return be(e)}}),Object(s.jsx)(f.a,{className:"ml-20",type:"primary",icon:Object(s.jsx)(T,{}),size:{size:"large"},onClick:function(){return w(!0),void k.a.get(C.a+"/person/import-export-person/plantilla").then((function(e){var t=e.headers["content-type"],n=new Blob([e.data],{type:t,encoding:"UTF-8"}),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download="PlantillaPersonas.csv",a.click(),w(!1)})).catch((function(e){w(!1),console.log(e)}))},children:"Descargar plantilla"})]})}),Object(s.jsx)(v.a,{className:"mainTable",size:"small",columns:ie,dataSource:t,loading:i,rowSelection:le})]}),Object(s.jsx)(A,{close:oe,visible:V}),Object(s.jsx)(y.a,{title:ae,visible:G,onOk:function(){k.a.post(C.a+"/person/person/delete_by_ids/",{persons_id:J}).then((function(e){fe(),re(),w(!1),d.b.success("Eliminado correctamente.")})).catch((function(e){w(!1),console.log(e)}))},onCancel:fe,okText:"Si, Eliminar",cancelText:"Cancelar",children:Object(s.jsx)("p",{style:{padding:"30px 60px"},children:"Al eliminar este registro perder\xe1 todos los datos relacionados a el de manera permanente. \xbfEst\xe1 seguro de querer eliminarlo?"})})]})}},z7Xi:function(e,t,n){"use strict";var a=n("q1tI"),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},r=n("6VBw"),o=function(e,t){return a.createElement(r.a,Object.assign({},e,{ref:t,icon:c}))};o.displayName="UploadOutlined";t.a=a.forwardRef(o)}},[["LrPk",0,2,15,23,1,3,6,5,4,7,8,9,10,11,12,13,16,17,18]]]);