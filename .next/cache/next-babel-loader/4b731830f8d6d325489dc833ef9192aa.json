{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { Layout, Breadcrumb, Table, Row, Col, Input, Select, Switch, Button, Modal, Form } from \"antd\";\nimport Axios from \"axios\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { DeleteOutlined, EditOutlined, InfoCircleOutlined, SearchOutlined, PlusOutlined } from \"@ant-design/icons\";\nimport HeaderCustom from \"../../components/Header\";\nimport { API_URL } from \"../../config/config\";\nimport Router from \"next/router\";\nimport MainLayout from \"../../layout/MainLayout\";\nvar TextArea = Input.TextArea;\nvar Content = Layout.Content;\nvar Option = Select.Option;\n\nvar businessForm = function businessForm() {\n  var _useState = useState([]),\n      business = _useState[0],\n      setBusiness = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      isModalVisible = _useState3[0],\n      setIsModalVisible = _useState3[1];\n\n  var _useState4 = useState(false),\n      isEdit = _useState4[0],\n      setIsEdit = _useState4[1];\n\n  var _Form$useForm = Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      formBusiness = _Form$useForm2[0];\n\n  var _useState5 = useState(false),\n      isModalDeleteVisible = _useState5[0],\n      setIsModalDeleteVisible = _useState5[1];\n\n  var _useState6 = useState(false),\n      isDeleted = _useState6[0],\n      setIsDeleted = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      businessName = _useState7[0],\n      setBusinessName = _useState7[1];\n\n  var _useState8 = useState(true),\n      isActive = _useState8[0],\n      setIsActive = _useState8[1];\n\n  var onFinish = function onFinish(values) {\n    if (isDeleted) {\n      deleteBusiness(values.id);\n    } else {\n      if (!isEdit) {\n        addBusiness(values.name, values.description, values.FNode);\n      } else {\n        updateBusiness(values.id, values.name, values.description, values.FNode, values.is_active);\n      }\n    }\n  };\n\n  var deleteBusiness = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(id, name, description) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              Axios[\"delete\"](API_URL + \"/business/node/\" + id + \"/\").then(function (response) {\n                if (response.status === 200) {\n                  Router.push(\"/business\");\n                }\n\n                getBusiness();\n                setIsModalVisible(false);\n                setIsModalDeleteVisible(false);\n                setLoading(false);\n              })[\"catch\"](function (error) {\n                setLoading(false);\n                console.log(error);\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function deleteBusiness(_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var updateBusiness = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id, name, description, fNode, is_active) {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              data = {\n                name: name,\n                description: description,\n                parent: fNode ? fNode : null,\n                is_active: is_active\n              };\n              Axios.put(API_URL + \"/business/node/\" + id + \"/\", data).then(function (response) {\n                if (response.status === 200) {\n                  Router.push(\"/business\");\n                }\n\n                getBusiness();\n                setIsModalVisible(false);\n                setLoading(false);\n              })[\"catch\"](function (error) {\n                setLoading(false);\n                console.log(error);\n              });\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function updateBusiness(_x4, _x5, _x6, _x7, _x8) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var addBusiness = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(name, description, fNode) {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              data = {\n                name: name,\n                description: description,\n                parent: fNode ? fNode : null\n              };\n              Axios.post(API_URL + \"/business/node/\", data).then(function (response) {\n                if (response.status === 200) {\n                  Router.push(\"/business\");\n                }\n\n                getBusiness();\n                setIsModalVisible(false);\n                setLoading(false);\n              })[\"catch\"](function (error) {\n                setLoading(false);\n                console.log(error);\n              });\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function addBusiness(_x9, _x10, _x11) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var showModal = function showModal(type, item) {\n    if (type === \"add\") {\n      setIsDeleted(false);\n      setIsEdit(false);\n      formBusiness.resetFields();\n      setIsModalVisible(true);\n    } else if (type === \"edit\") {\n      setIsDeleted(false);\n      setIsEdit(true);\n      formBusiness.setFieldsValue({\n        name: item.name,\n        description: item.description,\n        FNode: item.parent ? item.parent.id : null,\n        id: item.id\n      });\n      setIsModalVisible(true);\n    } else {\n      setIsDeleted(true);\n      setIsModalDeleteVisible(true);\n      setBusinessName(item.name);\n      formBusiness.setFieldsValue({\n        id: item.id\n      });\n    }\n  };\n\n  var handleOk = function handleOk() {\n    setIsModalVisible(false);\n  };\n\n  var handleCancel = function handleCancel() {\n    setIsModalVisible(false);\n    setIsModalDeleteVisible(false);\n  };\n\n  var getBusiness = function getBusiness() {\n    setLoading(true);\n    Axios.get(API_URL + \"/business/node/\").then(function (response) {\n      setBusiness(response.data.results);\n      setLoading(false);\n    })[\"catch\"](function (e) {\n      console.log(e);\n      setLoading(false);\n    });\n  };\n\n  useEffect(function () {\n    getBusiness();\n  }, []);\n  var columns = [{\n    title: \"Nombre\",\n    dataIndex: \"name\",\n    key: \"name\"\n  }, {\n    title: \"Nodo padre\",\n    dataIndex: \"parent\",\n    key: \"parent\",\n    render: function render(parent) {\n      return parent ? parent.name : null;\n    }\n  }, {\n    title: \"Estatus\",\n    dataIndex: \"active\",\n    key: \"active\",\n    render: function render(item) {\n      return /*#__PURE__*/_jsx(_Fragment, {\n        children: /*#__PURE__*/_jsx(Switch, {\n          defaultChecked: item,\n          checkedChildren: \"Activo\",\n          unCheckedChildren: \"Inactivo\" //   onChange={() => onchangeStatus(item)}\n\n        })\n      });\n    }\n  }, {\n    title: \"Opciones\",\n    render: function render(item) {\n      return /*#__PURE__*/_jsx(\"div\", {\n        children: /*#__PURE__*/_jsxs(Row, {\n          gutter: 16,\n          children: [/*#__PURE__*/_jsx(Col, {\n            className: \"gutter-row\",\n            span: 6,\n            children: /*#__PURE__*/_jsx(EditOutlined, {\n              onClick: function onClick() {\n                return showModal(\"edit\", item);\n              }\n            })\n          }), /*#__PURE__*/_jsx(Col, {\n            className: \"gutter-row\",\n            span: 6,\n            children: /*#__PURE__*/_jsx(DeleteOutlined, {\n              onClick: function onClick() {\n                return showModal(\"delete\", item);\n              }\n            })\n          })]\n        })\n      });\n    }\n  }];\n\n  var changeStatus = function changeStatus(value) {\n    isActive ? setIsActive(false) : setIsActive(true);\n  };\n\n  return /*#__PURE__*/_jsxs(MainLayout, {\n    currentKey: \"2\",\n    children: [/*#__PURE__*/_jsxs(Breadcrumb, {\n      children: [/*#__PURE__*/_jsx(Breadcrumb.Item, {\n        children: \"Inicio\"\n      }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n        children: \"Empresa\"\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"container\",\n      style: {\n        width: \"100%\"\n      },\n      children: [/*#__PURE__*/_jsx(Row, {\n        justify: \"end\",\n        children: /*#__PURE__*/_jsx(Col, {\n          children: /*#__PURE__*/_jsxs(Button, {\n            style: {\n              background: \"#fa8c16\",\n              fontWeight: \"bold\",\n              color: \"white\"\n            },\n            onClick: function onClick() {\n              return showModal(\"add\");\n            },\n            children: [/*#__PURE__*/_jsx(PlusOutlined, {}), \"Agregar empresa\"]\n          })\n        })\n      }), /*#__PURE__*/_jsx(Row, {\n        children: /*#__PURE__*/_jsx(Col, {\n          span: 24,\n          children: /*#__PURE__*/_jsx(Table, {\n            className: \"mainTable\",\n            size: \"small\",\n            columns: columns,\n            dataSource: business,\n            loading: loading\n          })\n        })\n      })]\n    }), /*#__PURE__*/_jsx(Modal, {\n      title: isEdit ? \"Actualizar empresa\" : \"Agregar empresa\",\n      visible: isModalVisible,\n      onCancel: function onCancel() {\n        return handleOk();\n      },\n      footer: [/*#__PURE__*/_jsx(Button, {\n        onClick: handleCancel,\n        children: \"Regresar\"\n      }, \"back\"), /*#__PURE__*/_jsx(Button, {\n        form: \"addBusinessForm\",\n        type: \"primary\",\n        htmlType: \"submit\",\n        children: isEdit ? \"Actualizar\" : \"Agregar\"\n      }, \"submit\")],\n      children: /*#__PURE__*/_jsxs(Form, {\n        id: \"addBusinessForm\",\n        name: \"normal_login\",\n        onFinish: onFinish,\n        layout: \"vertical\",\n        form: formBusiness,\n        children: [/*#__PURE__*/_jsx(Form.Item, {\n          name: \"id\",\n          label: \"id\",\n          style: {\n            display: \"none\"\n          },\n          children: /*#__PURE__*/_jsx(Input, {\n            type: \"text\"\n          })\n        }), /*#__PURE__*/_jsx(Form.Item, {\n          name: \"name\",\n          label: \"Nombre\",\n          rules: [{\n            required: true,\n            message: \"Ingresa un nombre\"\n          }],\n          children: /*#__PURE__*/_jsx(Input, {\n            placeholder: \"Nombre de la empresa\"\n          })\n        }), /*#__PURE__*/_jsx(Form.Item, {\n          name: \"description\",\n          label: \"Descripci\\xF3n\",\n          rules: [{\n            required: true,\n            message: \"Ingresa una descripciÃ³n\"\n          }],\n          children: /*#__PURE__*/_jsx(TextArea, {\n            rows: 4\n          })\n        }), /*#__PURE__*/_jsx(Form.Item, {\n          name: \"FNode\",\n          label: \"Nodo padre\",\n          children: /*#__PURE__*/_jsx(Select, {\n            showSearch: true,\n            placeholder: \"Select a person\",\n            optionFilterProp: \"children\",\n            name: \"fNode\",\n            filterOption: function filterOption(input, option) {\n              return option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\n            },\n            children: business.map(function (bus) {\n              return /*#__PURE__*/_jsx(Option, {\n                value: bus.id,\n                children: bus.name\n              });\n            })\n          })\n        }), isEdit ? /*#__PURE__*/_jsx(Form.Item, {\n          name: \"is_active\",\n          children: /*#__PURE__*/_jsx(Switch, {\n            checked: isActive,\n            onClick: changeStatus,\n            checkedChildren: \"Activo\",\n            unCheckedChildren: \"Inactivo\"\n          })\n        }) : /*#__PURE__*/_jsx(_Fragment, {})]\n      })\n    }), /*#__PURE__*/_jsx(Modal, {\n      title: \"Eliminar empresa \" + businessName,\n      visible: isModalDeleteVisible,\n      footer: [/*#__PURE__*/_jsx(Button, {\n        onClick: handleCancel,\n        children: \"Regresar\"\n      }, \"back\"), /*#__PURE__*/_jsx(Button, {\n        form: \"deleteBusinessForm\",\n        type: \"primary\",\n        htmlType: \"submit\",\n        children: \"Eliminar\"\n      }, \"submit\")],\n      children: /*#__PURE__*/_jsxs(Form, {\n        id: \"deleteBusinessForm\",\n        name: \"normal_login\",\n        onFinish: onFinish,\n        layout: \"vertical\",\n        form: formBusiness,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"float-label\",\n          children: /*#__PURE__*/_jsx(\"label\", {\n            children: \"\\xBFEst\\xE1 seguro de eliminar esta empresa?\"\n          })\n        }), /*#__PURE__*/_jsx(Form.Item, {\n          name: \"id\",\n          label: \"id\",\n          style: {\n            display: \"none\"\n          },\n          children: /*#__PURE__*/_jsx(Input, {\n            type: \"text\"\n          })\n        })]\n      })\n    })]\n  });\n};\n\nexport default businessForm;","map":null,"metadata":{},"sourceType":"module"}