{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Layout, Breadcrumb, Tabs, Form, Input, Modal, InputNumber, Row, Col, Spin, Card, Typography, Select, DatePicker, Button, Image, Switch, Collapse } from \"antd\";\nimport HeaderCustom from \"../../components/Header\";\nimport Axios from \"axios\";\nimport { API_URL } from \"../../config/config\";\nimport { useEffect, useState } from \"react\";\nconst {\n  Content\n} = Layout;\nconst {\n  TabPane\n} = Tabs;\nimport { useRouter } from \"next/router\";\nconst {\n  Option\n} = Select;\nimport moment from \"moment\";\nimport FormItem from \"antd/lib/form/FormItem\";\nconst {\n  Panel\n} = Collapse;\nconst {\n  Meta\n} = Card;\n\nconst userDetailForm = () => {\n  const router = useRouter();\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(true);\n  const [formPerson] = Form.useForm();\n  const [formGeneralTab] = Form.useForm();\n  const {\n    Title\n  } = Typography;\n  const {\n    0: personFullName,\n    1: setPersonFullName\n  } = useState(\"\");\n  const {\n    0: groups,\n    1: setGroups\n  } = useState([]);\n  const {\n    0: personType,\n    1: setPersonType\n  } = useState([]);\n  const {\n    0: jobs,\n    1: setJobs\n  } = useState([]);\n  const {\n    0: status,\n    1: setStatus\n  } = useState(false);\n  const {\n    0: treatments,\n    1: setTreatments\n  } = useState([]);\n  const {\n    0: photo,\n    1: setPhoto\n  } = useState(\"\");\n  const {\n    0: birthDate,\n    1: setBirthDate\n  } = useState(\"\");\n  const {\n    0: admissionDate,\n    1: setAdmissionDate\n  } = useState(\"\");\n  useEffect(() => {\n    getValueSelects();\n\n    if (router.query.id) {\n      Axios.get(API_URL + `/person/person/${router.query.id}`).then(response => {\n        console.log(\"RESPONSE PERSON-->> \", response.data);\n        formPerson.setFieldsValue({\n          first_name: response.data.first_name,\n          flast_name: response.data.flast_name,\n          mlast_name: response.data.mlast_name,\n          gender: response.data.gender,\n          email: response.data.email,\n          curp: response.data.curp,\n          rfc: response.data.rfc,\n          imss: response.data.imss,\n          is_active: response.data.is_active,\n          photo: response.data.photo,\n          civil_status: response.data.civil_status\n        });\n        if (response.data.person_type) formPerson.setFieldsValue({\n          person_type: response.data.person_type.id\n        });\n        if (response.data.job) formPerson.setFieldsValue({\n          person_type: response.data.job.id\n        }); // if (response.data.date_of_admission)\n        //   formPerson.setFieldsValue({\n        //     date_of_admission: moment(response.data.date_of_admission),\n        //   });\n\n        if (response.data.birth_date) formPerson.setFieldsValue({\n          birth_date: moment(response.data.birth_date)\n        });\n        setBirthDate(response.data.birth_date);\n        setStatus(response.data.is_active);\n        if (response.data.photo) setPhoto(response.data.photo);else setPhoto(\"https://khorplus.s3.amazonaws.com/demo/people/person/images/photo-profile/1412021224859/placeholder-profile-sq.jpg\");\n        setLoading(false);\n        setPersonFullName(response.data.first_name + \" \" + response.data.flast_name + \" \" + response.data.mlast_name);\n      }).catch(e => {\n        console.log(e);\n        setLoading(false);\n      });\n      Axios.get(API_URL + `/person/person/${router.query.id}/general_person/`).then(response => {\n        // console.log(\"RESPONSE GENERAL PERSON-->> \", response.data);\n        setLoading(false);\n      }).catch(e => {\n        console.log(e);\n        setLoading(false);\n      });\n    }\n  }, [router.query.id]);\n\n  const onFinish = value => {\n    value.birth_date = birthDate; // value.date_of_admission = admissionDate;\n\n    value.id = router.query.id;\n    console.log(\"Form-->>> \", value);\n    updatePerson(value);\n  };\n\n  const updatePerson = value => {\n    setLoading(true);\n    Axios.put(API_URL + `/person/person/${router.query.id}/`, value).then(response => {\n      console.log(\"PErson UPDATE-->>> \", response.data);\n      formPerson.setFieldsValue({\n        first_name: response.data.first_name,\n        flast_name: response.data.flast_name,\n        mlast_name: response.data.mlast_name,\n        gender: response.data.gender,\n        email: response.data.email,\n        birth_date: moment(response.data.birth_date),\n        curp: response.data.curp,\n        rfc: response.data.rfc,\n        imss: response.data.imss,\n        is_active: response.data.is_active,\n        person_type: response.data.person_type.id,\n        job: response.data.job.id,\n        photo: response.data.photo,\n        civil_status: response.data.civil_status,\n        date_of_admission: null\n      });\n      setStatus(response.data.is_active);\n      if (response.data.photo) setPhoto(response.data.photo);\n      setLoading(false);\n    }).catch(e => {\n      setLoading(false);\n      console.log(e);\n    });\n  };\n\n  const getValueSelects = async id => {\n    const headers = {\n      \"client-id\": \"5f417a53c37f6275fb614104\",\n      \"Content-Type\": \"application/json\"\n    };\n    Axios.get(\"https://khonnect.hiumanlab.com/group/list/\", {\n      headers: headers\n    }).then(response => {\n      if (response.status === 200) {\n        let group = response.data.data;\n        group = group.map(a => {\n          return {\n            label: a.name,\n            value: a.id\n          };\n        });\n        setGroups(group);\n      }\n    }).catch(e => {\n      console.log(e);\n    });\n    Axios.get(API_URL + `/person/person-type/`).then(response => {\n      if (response.status === 200) {\n        let typesPerson = response.data.results;\n        typesPerson = typesPerson.map(a => {\n          return {\n            label: a.name,\n            value: a.id\n          };\n        });\n        setPersonType(typesPerson);\n      }\n    }).catch(e => {\n      console.log(e);\n    });\n    Axios.get(API_URL + `/person/job/`).then(response => {\n      if (response.status === 200) {\n        let job = response.data.results;\n        job = job.map(a => {\n          return {\n            label: a.name,\n            value: a.id\n          };\n        });\n        setJobs(job);\n      }\n    }).catch(e => {\n      console.log(e);\n    });\n  };\n\n  const layout = {\n    labelCol: {\n      span: 5\n    },\n    wrapperCol: {\n      span: 10\n    }\n  };\n  const genders = [{\n    label: \"Maculino\",\n    value: 1\n  }, {\n    label: \"Femenino\",\n    value: 2\n  }, {\n    label: \"Otro\",\n    value: 3\n  }];\n  const civilStatus = [{\n    label: \"Soltero(a)\",\n    value: 1\n  }, {\n    label: \"Casado(a)\",\n    value: 2\n  }, {\n    label: \"Viudo(a)\",\n    value: 3\n  }];\n\n  function onChange(date, dateString) {\n    console.log(date, dateString);\n    setBirthDate(dateString);\n  }\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsxs(Layout, {\n      children: [/*#__PURE__*/_jsx(HeaderCustom, {}), /*#__PURE__*/_jsxs(Content, {\n        className: \"site-layout\",\n        style: {\n          padding: \"0 50px\",\n          marginTop: 64\n        },\n        children: [/*#__PURE__*/_jsxs(Breadcrumb, {\n          style: {\n            margin: \"16px 0\"\n          },\n          children: [/*#__PURE__*/_jsx(Breadcrumb.Item, {\n            children: \"Home\"\n          }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n            href: \"/home/\",\n            children: \"Person\"\n          }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n            children: \"Expediente de empleados\"\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"site-layout-background\",\n          style: {\n            padding: 24,\n            minHeight: 380,\n            height: \"100%\"\n          },\n          children: [/*#__PURE__*/_jsx(Title, {\n            level: 3,\n            children: \"Informaci\\xF3n Personal\"\n          }), /*#__PURE__*/_jsx(Title, {\n            level: 4,\n            style: {\n              marginTop: 0\n            },\n            children: personFullName\n          }), /*#__PURE__*/_jsxs(Spin, {\n            tip: \"Loading...\",\n            spinning: loading,\n            children: [/*#__PURE__*/_jsx(Form, {\n              onFinish: onFinish,\n              layout: \"vertical\",\n              form: formPerson,\n              children: /*#__PURE__*/_jsxs(Card, {\n                bordered: true,\n                children: [/*#__PURE__*/_jsxs(Row, {\n                  children: [/*#__PURE__*/_jsx(Col, {\n                    span: 18,\n                    pull: 1,\n                    children: /*#__PURE__*/_jsxs(Row, {\n                      flex: true,\n                      children: [/*#__PURE__*/_jsx(Col, {\n                        span: 10,\n                        offset: 2,\n                        children: /*#__PURE__*/_jsx(Form.Item, {\n                          name: \"flast_name\",\n                          label: \"Apellido Paterno\",\n                          rules: [{\n                            message: \"Ingresa un apellido paterno\"\n                          }],\n                          children: /*#__PURE__*/_jsx(Input, {\n                            size: \"small\"\n                          })\n                        })\n                      }), /*#__PURE__*/_jsx(Col, {\n                        span: 10,\n                        offset: 2,\n                        children: /*#__PURE__*/_jsx(Form.Item, {\n                          name: \"mlast_name\",\n                          label: \"Apellido Materno\",\n                          rules: [{\n                            message: \"Ingresa un apellido paterno\"\n                          }],\n                          children: /*#__PURE__*/_jsx(Input, {\n                            size: \"small\"\n                          })\n                        })\n                      }), /*#__PURE__*/_jsx(Col, {\n                        span: 10,\n                        offset: 2,\n                        children: /*#__PURE__*/_jsx(Form.Item, {\n                          name: \"first_name\",\n                          label: \"Nombre(s)\",\n                          rules: [{\n                            message: \"Ingresa un nombre\"\n                          }],\n                          children: /*#__PURE__*/_jsx(Input, {\n                            size: \"small\"\n                          })\n                        })\n                      }), /*#__PURE__*/_jsx(Col, {\n                        span: 10,\n                        offset: 2,\n                        children: /*#__PURE__*/_jsx(Form.Item, {\n                          name: \"job\",\n                          label: \"Puesto\",\n                          children: /*#__PURE__*/_jsx(Select, {\n                            options: jobs,\n                            placeholder: \"Selecciona un puesto\",\n                            size: \"small\"\n                          })\n                        })\n                      }), /*#__PURE__*/_jsx(Col, {\n                        span: 10,\n                        offset: 2,\n                        children: /*#__PURE__*/_jsx(Form.Item, {\n                          name: \"node\",\n                          label: \"Unidad organizacional\",\n                          children: /*#__PURE__*/_jsx(Input, {\n                            size: \"small\"\n                          })\n                        })\n                      }), /*#__PURE__*/_jsx(Col, {\n                        span: 10,\n                        offset: 2,\n                        children: /*#__PURE__*/_jsx(Form.Item, {\n                          name: \"unit\",\n                          label: \"Reporta a \",\n                          children: /*#__PURE__*/_jsx(Input, {\n                            size: \"small\"\n                          })\n                        })\n                      })]\n                    })\n                  }), /*#__PURE__*/_jsxs(Col, {\n                    span: 5,\n                    children: [/*#__PURE__*/_jsx(Image, {\n                      width: 200,\n                      src: photo\n                    }), /*#__PURE__*/_jsxs(Row, {\n                      children: [/*#__PURE__*/_jsx(Form.Item, {\n                        name: \"date_of_admission\",\n                        children: /*#__PURE__*/_jsx(DatePicker, {\n                          onChange: onChange,\n                          moment: \"YYYY-MM-DD\"\n                        })\n                      }), /*#__PURE__*/_jsx(Switch, {\n                        checked: status,\n                        checkedChildren: \"Activo\",\n                        unCheckedChildren: \"Inactivo\"\n                      })]\n                    })]\n                  })]\n                }), /*#__PURE__*/_jsx(Collapse, {\n                  children: /*#__PURE__*/_jsx(Panel, {\n                    header: \"Informacion adicional\",\n                    children: /*#__PURE__*/_jsx(Col, {\n                      span: 18,\n                      pull: 1,\n                      children: /*#__PURE__*/_jsxs(Row, {\n                        flex: true,\n                        children: [/*#__PURE__*/_jsx(Col, {\n                          span: 10,\n                          offset: 2,\n                          children: /*#__PURE__*/_jsx(Form.Item, {\n                            name: \"email\",\n                            label: \"Direcci\\xF3n de E-Mail\",\n                            rules: [{\n                              message: \"Ingresa un email\"\n                            }],\n                            children: /*#__PURE__*/_jsx(Input, {\n                              disabled: true\n                            })\n                          })\n                        }), /*#__PURE__*/_jsx(Col, {\n                          span: 10,\n                          offset: 2,\n                          children: /*#__PURE__*/_jsx(Form.Item, {\n                            name: \"birth_date\",\n                            label: \"Fecha de nacimiento\",\n                            children: /*#__PURE__*/_jsx(DatePicker, {\n                              onChange: onChange,\n                              moment: \"YYYY-MM-DD\",\n                              placeholder: \"Fecha de nacimiento\"\n                            })\n                          })\n                        }), /*#__PURE__*/_jsx(Col, {\n                          span: 10,\n                          offset: 2,\n                          children: /*#__PURE__*/_jsx(Form.Item, {\n                            name: \"civil_status\",\n                            label: \"Estado Civil\",\n                            children: /*#__PURE__*/_jsx(Select, {\n                              options: civilStatus,\n                              size: \"small\"\n                            })\n                          })\n                        }), /*#__PURE__*/_jsx(Col, {\n                          span: 10,\n                          offset: 2,\n                          children: /*#__PURE__*/_jsx(Form.Item, {\n                            name: \"gender\",\n                            label: \"G\\xE9nero\",\n                            children: /*#__PURE__*/_jsx(Select, {\n                              options: genders\n                            })\n                          })\n                        }), /*#__PURE__*/_jsx(Col, {\n                          span: 10,\n                          offset: 2,\n                          children: /*#__PURE__*/_jsx(Form.Item, {\n                            name: \"curp\",\n                            label: \"CURP\",\n                            children: /*#__PURE__*/_jsx(Input, {})\n                          })\n                        }), /*#__PURE__*/_jsx(Col, {\n                          span: 10,\n                          offset: 2,\n                          children: /*#__PURE__*/_jsx(Form.Item, {\n                            name: \"rfc\",\n                            label: \"RFC\",\n                            children: /*#__PURE__*/_jsx(Input, {})\n                          })\n                        }), /*#__PURE__*/_jsx(Col, {\n                          span: 10,\n                          offset: 2,\n                          children: /*#__PURE__*/_jsx(Form.Item, {\n                            name: \"imss\",\n                            label: \"IMSS\",\n                            children: /*#__PURE__*/_jsx(Input, {})\n                          })\n                        })]\n                      })\n                    })\n                  })\n                }), /*#__PURE__*/_jsx(Row, {\n                  flex: true,\n                  children: /*#__PURE__*/_jsxs(Form.Item, {\n                    children: [/*#__PURE__*/_jsx(Button, {\n                      type: \"primary\",\n                      htmlType: \"submit\",\n                      children: \"Guardar\"\n                    }), /*#__PURE__*/_jsx(Button, {\n                      htmlType: \"button\",\n                      children: \"Regresar\"\n                    })]\n                  })\n                })]\n              })\n            }), /*#__PURE__*/_jsxs(Tabs, {\n              type: \"card\",\n              defaultActiveKey: \"1\",\n              style: {\n                marginTop: \"40px\"\n              },\n              children: [/*#__PURE__*/_jsx(TabPane, {\n                tab: \"Generales\",\n                children: \"Content of Tab Pane 2\"\n              }, \"2\"), /*#__PURE__*/_jsx(TabPane, {\n                tab: \"Adicionales\",\n                children: \"Content of Tab Pane 3\"\n              }, \"3\")]\n            })]\n          })]\n        })]\n      })]\n    })\n  });\n};\n\nexport default userDetailForm;","map":null,"metadata":{},"sourceType":"module"}