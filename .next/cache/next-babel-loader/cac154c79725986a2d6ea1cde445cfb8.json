{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from 'react';\nimport MainLayout from '../../../layout/MainLayout';\nimport { Row, Col, Typography, Table, Breadcrumb, Image, Button, Form, Input, InputNumber, Select, DatePicker, notification, Space, Switch } from \"antd\";\nimport { useRouter } from \"next/router\";\nimport axiosApi from \"../../../libs/axiosApi\";\nimport moment from \"moment\";\nimport Vacationform from '../../../components/vacations/Vacationform';\nexport default function HolidaysNew() {\n  var route = useRouter();\n\n  var _Form$useForm = Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var Title = Typography.Title;\n\n  var _useState = useState(false),\n      sending = _useState[0],\n      setSending = _useState[1];\n\n  var Option = Select.Option;\n\n  var _useState2 = useState(null),\n      departure_date = _useState2[0],\n      setDepartureDate = _useState2[1];\n\n  var _useState3 = useState(null),\n      return_date = _useState3[0],\n      setReturnDate = _useState3[1];\n\n  var _useState4 = useState(null),\n      job = _useState4[0],\n      setJob = _useState4[1];\n\n  var _useState5 = useState(null),\n      dateOfAdmission = _useState5[0],\n      setDateOfAdmission = _useState5[1];\n\n  var _useState6 = useState(null),\n      personList = _useState6[0],\n      setPersonList = _useState6[1];\n\n  var _useState7 = useState(null),\n      allPersons = _useState7[0],\n      setAllPersons = _useState7[1];\n\n  var onCancel = function onCancel() {\n    route.push(\"/holidays\");\n  };\n\n  var changePerson = function changePerson(value) {\n    console.log(value);\n    var index = allPersons.find(function (data) {\n      return data.khonnect_id === value;\n    });\n    console.log(index);\n    setDateOfAdmission(moment(index.date_of_admission).format('DD/MM/YYYY'));\n\n    if (index.job_department.job) {\n      setJob(index.job_department.job.name);\n    }\n  };\n\n  var saveRequest = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n      var response, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              values['departure_date'] = departure_date;\n              values['return_date'] = return_date;\n              console.log(values);\n              setSending(true);\n              _context.prev = 4;\n              _context.next = 7;\n              return axiosApi.post(\"/person/vacation/\", values);\n\n            case 7:\n              response = _context.sent;\n              data = response.data;\n              notification[\"success\"]({\n                message: \"Notification Title\",\n                description: \"Informaci√≥n enviada correctamente.\"\n              });\n              route.push(\"/holidays\");\n              console.log(\"res\", response.data);\n              _context.next = 17;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](4);\n              console.log(\"error\", _context.t0);\n\n            case 17:\n              _context.prev = 17;\n              setSending(false);\n              return _context.finish(17);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 14, 17, 20]]);\n    }));\n\n    return function saveRequest(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var onChangeDepartureDate = function onChangeDepartureDate(date, dateString) {\n    console.log('date', date);\n    console.log('dateString', dateString);\n    setDepartureDate(dateString);\n  };\n\n  var onChangeReturnDate = function onChangeReturnDate(date, dateString) {\n    setReturnDate(dateString);\n  };\n\n  var getAllPersons = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var response, data;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return axiosApi.get(\"/person/person/\");\n\n            case 3:\n              response = _context2.sent;\n              data = response.data.results;\n              setAllPersons(data);\n              console.log(data);\n              data = data.map(function (a) {\n                return {\n                  label: a.first_name + ' ' + a.flast_name,\n                  value: a.khonnect_id,\n                  key: a.name + a.id\n                };\n              });\n              setPersonList(data);\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 11]]);\n    }));\n\n    return function getAllPersons() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getAllPersons();\n  }, [route]);\n  return /*#__PURE__*/_jsxs(MainLayout, {\n    currentKey: \"5\",\n    children: [/*#__PURE__*/_jsxs(Breadcrumb, {\n      className: 'mainBreadcrumb',\n      children: [/*#__PURE__*/_jsx(Breadcrumb.Item, {\n        children: \"Inicio\"\n      }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n        href: \"./\",\n        children: \"Vacaciones\"\n      }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n        children: \"Nueva solicitud\"\n      })]\n    }, \"Breadcrumb\"), /*#__PURE__*/_jsx(\"div\", {\n      className: \"container back-white\",\n      style: {\n        width: \"100%\",\n        padding: '20px 0'\n      },\n      children: /*#__PURE__*/_jsx(Row, {\n        justify: 'center',\n        children: /*#__PURE__*/_jsx(Col, {\n          span: 23,\n          children: /*#__PURE__*/_jsx(Form, {\n            form: form,\n            layout: \"horizontal\",\n            onFinish: saveRequest,\n            children: /*#__PURE__*/_jsx(Vacationform, {\n              sending: sending,\n              dateOfAdmission: dateOfAdmission,\n              job: job,\n              personList: personList,\n              onChangeDepartureDate: onChangeDepartureDate,\n              onChangeReturnDate: onChangeReturnDate,\n              onCancel: onCancel,\n              changePerson: changePerson\n            })\n          })\n        })\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}