{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from \"react\";\nimport MainLayout from \"../../../layout/MainLayout\";\nimport { Row, Col, Typography, Table, Breadcrumb, Image, Button, Form, Input, InputNumber, Select, DatePicker, notification, Space, Switch } from \"antd\";\nimport { useRouter } from \"next/router\";\nimport axiosApi from \"../../../libs/axiosApi\";\nimport moment from \"moment\";\nimport Vacationform from \"../../../components/vacations/Vacationform\";\nexport default function HolidaysNew() {\n  const route = useRouter();\n  const [form] = Form.useForm();\n  const {\n    Title\n  } = Typography;\n  const {\n    0: sending,\n    1: setSending\n  } = useState(false);\n  const {\n    Option\n  } = Select;\n  const {\n    0: departure_date,\n    1: setDepartureDate\n  } = useState(null);\n  const {\n    0: return_date,\n    1: setReturnDate\n  } = useState(null);\n  const {\n    0: job,\n    1: setJob\n  } = useState(null);\n  const {\n    0: dateOfAdmission,\n    1: setDateOfAdmission\n  } = useState(null);\n  const {\n    0: availableDays,\n    1: setAvailableDays\n  } = useState(null);\n  const {\n    0: personList,\n    1: setPersonList\n  } = useState(null);\n  const {\n    0: allPersons,\n    1: setAllPersons\n  } = useState(null);\n  const {\n    0: antiquity,\n    1: setAntiquity\n  } = useState(null);\n\n  const onCancel = () => {\n    route.push(\"/holidays\");\n  };\n\n  const changePerson = value => {\n    console.log(value);\n    let index = allPersons.find(data => data.khonnect_id === value);\n    console.log(index);\n    setDateOfAdmission(moment(index.date_of_admission).format('DD/MM/YYYY'));\n\n    if (index.job_department.job) {\n      setJob(index.job_department.job.name);\n      setAvailableDays(index.Available_days_vacation);\n      setAntiquity(index.antiquity);\n    }\n  };\n\n  const saveRequest = async values => {\n    values[\"departure_date\"] = departure_date;\n    values[\"return_date\"] = return_date;\n    console.log(values);\n    setSending(true);\n\n    try {\n      let response = await axiosApi.post(`/person/vacation/`, values);\n      let data = response.data;\n      notification[\"success\"]({\n        message: \"Aviso\",\n        description: \"InformaciÃ³n enviada correctamente.\"\n      });\n      route.push(\"/holidays\");\n      console.log(\"res\", response.data);\n    } catch (error) {\n      console.log(\"error\", error);\n    } finally {\n      setSending(false);\n    }\n  };\n\n  const onChangeDepartureDate = (date, dateString) => {\n    console.log(\"date\", date);\n    console.log(\"dateString\", dateString);\n    setDepartureDate(dateString);\n  };\n\n  const onChangeReturnDate = (date, dateString) => {\n    setReturnDate(dateString);\n  };\n\n  const getAllPersons = async () => {\n    try {\n      let response = await axiosApi.get(`/person/person/`);\n      let data = response.data.results;\n      setAllPersons(data);\n      console.log(data);\n      data = data.map(a => {\n        return {\n          label: a.first_name + \" \" + a.flast_name,\n          value: a.khonnect_id,\n          key: a.name + a.id\n        };\n      });\n      setPersonList(data);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  useEffect(() => {\n    getAllPersons();\n  }, [route]);\n  return /*#__PURE__*/_jsxs(MainLayout, {\n    currentKey: \"5\",\n    children: [/*#__PURE__*/_jsxs(Breadcrumb, {\n      className: 'mainBreadcrumb',\n      children: [/*#__PURE__*/_jsx(Breadcrumb.Item, {\n        children: \"Inicio\"\n      }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n        href: \"./\",\n        children: \"Vacaciones\"\n      }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n        children: \"Nueva solicitud\"\n      })]\n    }, \"Breadcrumb\"), /*#__PURE__*/_jsx(\"div\", {\n      className: \"container back-white\",\n      style: {\n        width: \"100%\",\n        padding: '20px 0'\n      },\n      children: /*#__PURE__*/_jsx(Row, {\n        justify: 'center',\n        children: /*#__PURE__*/_jsx(Col, {\n          span: 23,\n          children: /*#__PURE__*/_jsx(Form, {\n            form: form,\n            layout: \"horizontal\",\n            onFinish: saveRequest,\n            children: /*#__PURE__*/_jsx(Vacationform, {\n              sending: sending,\n              antiquity: antiquity,\n              availableDays: availableDays,\n              dateOfAdmission: dateOfAdmission,\n              job: job,\n              personList: personList,\n              onChangeDepartureDate: onChangeDepartureDate,\n              onChangeReturnDate: onChangeReturnDate,\n              onCancel: onCancel,\n              changePerson: changePerson\n            })\n          })\n        })\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}