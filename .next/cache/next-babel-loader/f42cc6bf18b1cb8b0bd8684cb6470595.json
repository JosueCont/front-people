{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Layout, Breadcrumb, Table, Row, Col, Input, Select, Switch, Button, Form } from \"antd\";\nimport Axios from \"axios\";\nimport { API_URL } from \"../../config/config\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { DeleteOutlined, EditOutlined, InfoCircleOutlined, SearchOutlined, PlusOutlined, DownloadOutlined } from \"@ant-design/icons\";\nimport HeaderCustom from \"../../components/Header\";\nimport _ from \"lodash\";\nimport FormPerson from \"../../components/person/FormPerson\";\nconst {\n  Content\n} = Layout;\nimport Link from \"next/link\";\n\nconst homeScreen = () => {\n  const {\n    0: person,\n    1: setPerson\n  } = useState([]);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: status,\n    1: setStatus\n  } = useState(true);\n  const {\n    0: modal,\n    1: setModal\n  } = useState(false);\n  const [formFilter] = Form.useForm();\n  let filters = {};\n\n  const getPerson = text => {\n    setLoading(true);\n\n    if (text == undefined) {\n      Axios.get(API_URL + `/person/person/`).then(response => {\n        // console.log(\"RESPONSE-->> \", response);\n        response.data.results.map(item => {\n          item[\"key\"] = item.id;\n          item[\"fullname\"] = item.first_name + \" \" + item.flast_name + \" \" + item.mlast_name;\n          item.timestamp = item.timestamp.substring(0, 10);\n        });\n        setPerson(response.data.results);\n        setLoading(false);\n      }).catch(e => {\n        console.log(e);\n      });\n    } else {\n      Axios.post(API_URL + `/person/person/get_list_persons/ `, filters).then(response => {\n        console.log(\"RESPONSE-->> \", response);\n        response.data.map(item => {\n          item[\"key\"] = item.id;\n          item[\"fullname\"] = item.first_name + \" \" + item.flast_name + \" \" + item.mlast_name;\n          item.timestamp = item.timestamp.substring(0, 10);\n        });\n        setPerson(response.data);\n        setLoading(false);\n      }).catch(e => {\n        setPerson([]);\n        setLoading(false);\n        console.log(e);\n      });\n    }\n  };\n\n  const statusPeron = () => {\n    console.log(status);\n    setStatus(status ? false : true);\n  };\n\n  const filter = value => {\n    console.log(\"LOS FILTROS\", value);\n\n    if (value.name !== undefined && value.name !== \"\") {\n      filters.first_name = value.name;\n    }\n\n    if (value.gender !== undefined) {\n      filters.gender = value.gender;\n    }\n\n    if (status !== undefined) {\n      filters.is_active = status == false ? 0 : 1;\n    }\n\n    console.log(filters);\n    getPerson(\"filter\");\n  };\n\n  useEffect(() => {\n    getPerson();\n  }, []);\n  const columns = [{\n    title: \"Nombre\",\n    dataIndex: \"fullname\",\n    key: \"fullname\"\n  }, {\n    title: \"Fecha de registro\",\n    dataIndex: \"timestamp\",\n    key: \"timestamp\"\n  }, {\n    title: \"RFC\",\n    dataIndex: \"rfc\",\n    key: \"rfc\"\n  }, {\n    title: \"IMSS\",\n    dataIndex: \"imss\",\n    key: \"imss\"\n  }, {\n    title: \"Opciones\",\n    render: item => {\n      return /*#__PURE__*/_jsx(\"div\", {\n        children: /*#__PURE__*/_jsxs(Row, {\n          gutter: 16,\n          children: [/*#__PURE__*/_jsx(Col, {\n            className: \"gutter-row\",\n            span: 6,\n            children: /*#__PURE__*/_jsx(Link, {\n              href: `/home/${item.id}`,\n              children: /*#__PURE__*/_jsx(EditOutlined, {})\n            })\n          }), /*#__PURE__*/_jsx(Col, {\n            className: \"gutter-row\",\n            span: 6,\n            children: /*#__PURE__*/_jsx(DeleteOutlined, {})\n          }), /*#__PURE__*/_jsx(Col, {\n            className: \"gutter-row\",\n            span: 6,\n            children: /*#__PURE__*/_jsx(InfoCircleOutlined, {})\n          })]\n        })\n      });\n    }\n  }];\n  const genders = [{\n    label: \"Maculino\",\n    value: 1\n  }, {\n    label: \"Femenino\",\n    value: 2\n  }, {\n    label: \"Otro\",\n    value: 3\n  }];\n\n  const getModal = value => {\n    console.log(\"Open Modal-->> \", modal);\n    setModal(value);\n  };\n\n  const downloadPersons = () => {\n    setLoading(true);\n    Axios.get(API_URL + `/person/import-export-person/csv`).then(response => {\n      console.log(\"RESPONSE-->> \", response);\n      const type = response.headers['content-type'];\n      const blob = new Blob([response.data], {\n        type: type,\n        encoding: 'UTF-8'\n      });\n      const link = document.createElement('a');\n      link.href = window.URL.createObjectURL(blob);\n      link.download = 'Personas.csv';\n      link.click();\n      setLoading(false);\n    }).catch(e => {\n      setLoading(false);\n      console.log(e);\n    });\n  };\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsxs(Layout, {\n      children: [/*#__PURE__*/_jsx(HeaderCustom, {}), /*#__PURE__*/_jsxs(Content, {\n        className: \"site-layout\",\n        style: {\n          padding: \"0 50px\",\n          marginTop: 64\n        },\n        children: [/*#__PURE__*/_jsxs(Breadcrumb, {\n          style: {\n            margin: \"16px 0\"\n          },\n          children: [/*#__PURE__*/_jsx(Breadcrumb.Item, {\n            children: \"Home\"\n          }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n            children: \"Person\"\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          style: {\n            padding: \"1%\",\n            float: \"right\"\n          },\n          children: /*#__PURE__*/_jsxs(Button, {\n            style: {\n              background: \"#fa8c16\",\n              fontWeight: \"bold\",\n              color: \"white\"\n            },\n            onClick: () => getModal(true),\n            children: [/*#__PURE__*/_jsx(PlusOutlined, {}), \"Agregar persona\"]\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"site-layout-background\",\n          style: {\n            padding: 24,\n            minHeight: 380,\n            height: \"100%\"\n          },\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            style: {\n              padding: 24\n            },\n            children: [/*#__PURE__*/_jsxs(Form, {\n              onFinish: filter,\n              layout: \"vertical\",\n              form: formFilter,\n              children: [/*#__PURE__*/_jsxs(Row, {\n                children: [/*#__PURE__*/_jsx(Col, {\n                  span: 18,\n                  children: /*#__PURE__*/_jsx(Form.Item, {\n                    name: \"name\",\n                    children: /*#__PURE__*/_jsx(Input, {\n                      placeholder: \"Nombre...\"\n                    })\n                  })\n                }), /*#__PURE__*/_jsx(Col, {\n                  span: 5,\n                  children: /*#__PURE__*/_jsx(Form.Item, {\n                    name: \"gender\",\n                    children: /*#__PURE__*/_jsx(Select, {\n                      style: {\n                        marginLeft: \"10%\",\n                        width: \"100%\"\n                      },\n                      options: genders,\n                      placeholder: \"G\\xE9nero\"\n                    })\n                  })\n                })]\n              }), /*#__PURE__*/_jsxs(Row, {\n                style: {\n                  marginTop: \"2%\"\n                },\n                children: [/*#__PURE__*/_jsx(Col, {\n                  span: 4,\n                  children: /*#__PURE__*/_jsxs(Form.Item, {\n                    name: \"is_active\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: /*#__PURE__*/_jsx(\"span\", {\n                        style: {\n                          fontWeight: \"bold\"\n                        },\n                        children: \"Activos:\"\n                      })\n                    }), /*#__PURE__*/_jsx(Switch, {\n                      style: {\n                        marginLeft: \"10%\"\n                      },\n                      defaultChecked: true,\n                      onChange: statusPeron\n                    })]\n                  })\n                }), /*#__PURE__*/_jsx(Col, {\n                  span: 8,\n                  style: {\n                    float: \"right\"\n                  },\n                  children: /*#__PURE__*/_jsx(Form.Item, {\n                    children: /*#__PURE__*/_jsx(Button, {\n                      type: \"primary\",\n                      htmlType: \"submit\",\n                      children: \"Buscar\"\n                    })\n                  })\n                })]\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              style: {\n                float: 'right'\n              },\n              children: /*#__PURE__*/_jsx(Button, {\n                type: \"primary\",\n                icon: /*#__PURE__*/_jsx(DownloadOutlined, {}),\n                size: {\n                  size: 'large'\n                },\n                onClick: () => downloadPersons(),\n                children: \"Descargar resultados\"\n              })\n            })]\n          }), /*#__PURE__*/_jsx(Table, {\n            size: \"small\",\n            columns: columns,\n            dataSource: person,\n            loading: loading\n          })]\n        })]\n      }), /*#__PURE__*/_jsx(FormPerson, {\n        close: getModal,\n        visible: modal\n      })]\n    })\n  });\n};\n\nexport default homeScreen;","map":null,"metadata":{},"sourceType":"module"}