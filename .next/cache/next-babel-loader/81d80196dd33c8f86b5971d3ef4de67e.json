{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport MainLayout from \"../../../../layout/MainLayout\";\nimport { Row, Col, Typography, Table, Breadcrumb, Button, Form, Input, Select, DatePicker, notification, Space, Switch } from \"antd\";\nimport { useRouter } from \"next/router\";\nimport axiosApi from \"../../../../libs/axiosApi\";\nimport cookie from \"js-cookie\";\nimport Axios from \"axios\";\nimport { API_URL } from \"../../../../config/config\";\nimport \"froala-editor/css/froala_style.min.css\";\nimport \"froala-editor/css/froala_editor.pkgd.min.css\"; // import { FroalaEditorComponent } from \"react-froala-wysiwyg\";\n\nimport dynamic from \"next/dynamic\";\nvar FroalaEditorComponent = dynamic(function () {\n  return import(\"react-froala-wysiwyg\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-froala-wysiwyg\")];\n    },\n    modules: [\"react-froala-wysiwyg\"]\n  }\n});\n\nvar Newrelease = function Newrelease() {\n  var userToken = cookie.get(\"userToken\") ? cookie.get(\"userToken\") : null;\n\n  var _Form$useForm = Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var Title = Typography.Title;\n  var TextArea = Input.TextArea;\n  var route = useRouter();\n\n  var _useState = useState(null),\n      message = _useState[0],\n      setMessage = _useState[1];\n\n  var _useState2 = useState(false),\n      sending = _useState2[0],\n      setSending = _useState2[1];\n\n  var _useState3 = useState(null),\n      userId = _useState3[0],\n      setUserId = _useState3[1];\n\n  var _useState4 = useState(null),\n      bussinessList = _useState4[0],\n      setBusinessList = _useState4[1];\n\n  var _useState5 = useState([]),\n      personType = _useState5[0],\n      setPersonType = _useState5[1];\n\n  var _useState6 = useState([]),\n      jobs = _useState6[0],\n      setJobs = _useState6[1];\n\n  var _useState7 = useState([]),\n      departments = _useState7[0],\n      setDepartments = _useState7[1];\n\n  var json = JSON.parse(userToken);\n  useEffect(function () {\n    if (json) {\n      setUserId(json.user_id);\n      /* getBussiness(); */\n\n      getValueSelects();\n    }\n  }, []);\n\n  var saveNotification = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n      var response, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              values[\"khonnect_id\"] = userId;\n              values[\"created_by\"] = userId;\n              values[\"message\"] = message;\n              console.log(values);\n              setSending(true);\n              _context.prev = 5;\n              _context.next = 8;\n              return axiosApi.post(\"/noticenter/notification/\", values);\n\n            case 8:\n              response = _context.sent;\n              data = response.data;\n              notification[\"success\"]({\n                message: \"Aviso\",\n                description: \"Informaci√≥n enviada correctamente.\"\n              });\n              route.push(\"/comunication/releases\");\n              console.log(\"res\", response.data);\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](5);\n              console.log(\"error\", _context.t0);\n\n            case 18:\n              _context.prev = 18;\n              setSending(false);\n              return _context.finish(18);\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 15, 18, 21]]);\n    }));\n\n    return function saveNotification(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getBussiness = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var response, data, options;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return axiosApi.get(\"/business/node/\");\n\n            case 3:\n              response = _context2.sent;\n              data = response.data.results;\n              console.log(\"data\", data);\n              options = [];\n              data.map(function (item) {\n                options.push({\n                  id: item.id,\n                  name: item.name\n                });\n              });\n              console.log();\n              setBusinessList(options); //  notification['success']({\n              //           message: 'Notification Title',\n              //           description:\n              //             'This is the content of the notification. This is the content of the notification. This is the content of the notification.',\n              //         });\n              //         route.push('/comunication/releases');\n\n              _context2.next = 15;\n              break;\n\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(\"error\", _context2.t0);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 12]]);\n    }));\n\n    return function getBussiness() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var onCancel = function onCancel() {\n    route.push(\"/comunication/releases\");\n  };\n\n  var genders = [{\n    label: \"Masculino\",\n    value: 1\n  }, {\n    label: \"Femenino\",\n    value: 2\n  }, {\n    label: \"Otro\",\n    value: 3\n  }];\n  var typeMessage = [{\n    label: \"Noticias\",\n    value: 2\n  }, {\n    label: \"Aviso\",\n    value: 1\n  }]; /////GET DATA SELCTS\n\n  var getValueSelects = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var response, data, options;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              /////PERSON TYPE\n              Axios.get(API_URL + \"/person/person-type/\").then(function (response) {\n                console.log(\"response\", response);\n\n                if (response.status === 200) {\n                  var typesPerson = response.data.results;\n                  typesPerson = typesPerson.map(function (a) {\n                    return {\n                      label: a.name,\n                      value: a.id\n                    };\n                  });\n                  setPersonType(typesPerson);\n                }\n              })[\"catch\"](function (e) {\n                console.log(e);\n              }); /////Companies\n\n              _context3.prev = 1;\n              _context3.next = 4;\n              return axiosApi.get(\"/business/node/\");\n\n            case 4:\n              response = _context3.sent;\n              data = response.data.results;\n              console.log(\"data\", data);\n              options = [];\n              data.map(function (item) {\n                options.push({\n                  value: item.id,\n                  label: item.name\n                });\n              });\n              setBusinessList(options);\n              _context3.next = 15;\n              break;\n\n            case 12:\n              _context3.prev = 12;\n              _context3.t0 = _context3[\"catch\"](1);\n              console.log(\"error\", _context3.t0);\n\n            case 15:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[1, 12]]);\n    }));\n\n    return function getValueSelects() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var onChangecompany = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(value) {\n      var response, data;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              console.log(value);\n              /* Clear form in specific fields */\n\n              form.setFieldsValue({\n                target_department: null,\n                target_job: null\n              });\n              _context4.prev = 2;\n              _context4.next = 5;\n              return axiosApi.get(\"business/node/\".concat(value, \"/department_for_node/\"));\n\n            case 5:\n              response = _context4.sent;\n              data = response.data;\n              console.log(\"data\", data);\n              data = data.map(function (a) {\n                return {\n                  label: a.name,\n                  value: a.id,\n                  key: a.name + a.id\n                };\n              });\n              setDepartments(data);\n              _context4.next = 15;\n              break;\n\n            case 12:\n              _context4.prev = 12;\n              _context4.t0 = _context4[\"catch\"](2);\n              console.log(\"error\", _context4.t0);\n\n            case 15:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[2, 12]]);\n    }));\n\n    return function onChangecompany(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var onChangeDepartment = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(value) {\n      var response, data_jobs;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              ////JOBS\n              form.setFieldsValue({\n                target_job: null\n              });\n              console.log(\"business/department/\".concat(value, \"/job_for_department/\"));\n              _context5.prev = 2;\n              _context5.next = 5;\n              return axiosApi.get(\"business/department/\".concat(value, \"/job_for_department/\"));\n\n            case 5:\n              response = _context5.sent;\n              data_jobs = response.data;\n              console.log(\"data_jobs\", data_jobs);\n              data_jobs = data_jobs.map(function (a, index) {\n                return {\n                  label: a.name,\n                  value: a.id,\n                  key: a.name + index\n                };\n              });\n              setJobs(data_jobs);\n              _context5.next = 14;\n              break;\n\n            case 12:\n              _context5.prev = 12;\n              _context5.t0 = _context5[\"catch\"](2);\n\n            case 14:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[2, 12]]);\n    }));\n\n    return function onChangeDepartment(_x3) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(MainLayout, {\n    currentKey: \"4.1\",\n    children: [/*#__PURE__*/_jsxs(Breadcrumb, {\n      children: [/*#__PURE__*/_jsx(Breadcrumb.Item, {\n        children: \"Inicio\"\n      }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n        href: \"./\",\n        children: \"Comunicados\"\n      }), /*#__PURE__*/_jsx(Breadcrumb.Item, {\n        children: \"Nuevo\"\n      })]\n    }, \"Breadcrumb\"), /*#__PURE__*/_jsx(\"div\", {\n      className: \"container back-white\",\n      style: {\n        width: \"100%\"\n      },\n      children: /*#__PURE__*/_jsx(Row, {\n        justify: \"center\",\n        children: /*#__PURE__*/_jsx(Col, {\n          span: \"23\",\n          style: {\n            padding: \"20px 0 30px 0\"\n          },\n          children: /*#__PURE__*/_jsx(Form, {\n            form: form,\n            layout: \"horizontal\",\n            labelCol: {\n              xs: 24,\n              sm: 24,\n              md: 5\n            },\n            onFinish: saveNotification,\n            children: /*#__PURE__*/_jsxs(Row, {\n              children: [/*#__PURE__*/_jsx(Col, {\n                span: 24,\n                children: /*#__PURE__*/_jsx(Title, {\n                  level: 3,\n                  children: \"Datos Generales\"\n                }, \"dats_gnrl\")\n              }), /*#__PURE__*/_jsxs(Col, {\n                xs: 24,\n                sm: 24,\n                md: 13,\n                lg: 13,\n                xl: 13,\n                children: [/*#__PURE__*/_jsx(Form.Item, {\n                  name: \"category\",\n                  label: \"Categor\\xEDa\",\n                  labelAlign: \"left\",\n                  children: /*#__PURE__*/_jsx(Select, {\n                    style: {\n                      width: 250\n                    },\n                    options: typeMessage\n                  })\n                }), /*#__PURE__*/_jsx(Form.Item, {\n                  label: \"T\\xEDtulo\",\n                  name: \"title\",\n                  labelAlign: \"left\",\n                  children: /*#__PURE__*/_jsx(Input, {\n                    className: \"formItemPayment\"\n                  })\n                }), /*#__PURE__*/_jsx(Form.Item, {\n                  name: \"message\",\n                  label: \"Mensaje\",\n                  labelAlign: \"left\",\n                  children: /*#__PURE__*/_jsx(FroalaEditorComponent, {\n                    tag: \"textarea\",\n                    model: message,\n                    onModelChange: setMessage\n                  }, \"message\")\n                })]\n              }), /*#__PURE__*/_jsx(Col, {\n                span: 24,\n                children: /*#__PURE__*/_jsx(Title, {\n                  level: 3,\n                  children: \"Segmentaci\\xF3n\"\n                }, \"segmentacion\")\n              }), /*#__PURE__*/_jsx(Col, {\n                xs: 24,\n                sm: 24,\n                md: 13,\n                lg: 13,\n                xl: 13,\n                children: /*#__PURE__*/_jsx(Form.Item, {\n                  name: \"send_to_all\",\n                  label: \"Enviar a todos\",\n                  labelAlign: \"left\",\n                  children: /*#__PURE__*/_jsx(Switch, {\n                    value: false\n                  })\n                })\n              }), /*#__PURE__*/_jsx(Col, {\n                xs: 24,\n                sm: 24,\n                md: 13,\n                lg: 13,\n                xl: 13,\n                children: /*#__PURE__*/_jsxs(Row, {\n                  children: [/*#__PURE__*/_jsxs(Col, {\n                    xs: 24,\n                    sm: 24,\n                    md: 12,\n                    lg: 12,\n                    xl: 12,\n                    children: [/*#__PURE__*/_jsx(Form.Item, {\n                      name: \"company\",\n                      label: \"Empresa\",\n                      labelCol: {\n                        span: 10\n                      },\n                      children: /*#__PURE__*/_jsx(Select, {\n                        options: bussinessList,\n                        onChange: onChangecompany,\n                        placeholder: \"Empresa\"\n                      }, \"company_select\")\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"target_department\",\n                      label: \"Departamento\",\n                      labelCol: {\n                        span: 10\n                      },\n                      children: /*#__PURE__*/_jsx(Select, {\n                        options: departments,\n                        onChange: onChangeDepartment,\n                        placeholder: \"Departamento\"\n                      }, \"departament_select\")\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"target_job\",\n                      label: \"Puesto de trabajo\",\n                      labelCol: {\n                        span: 10\n                      },\n                      children: /*#__PURE__*/_jsx(Select, {\n                        options: jobs\n                      }, \"jobs_select\")\n                    })]\n                  }), /*#__PURE__*/_jsxs(Col, {\n                    xs: 24,\n                    sm: 24,\n                    md: 12,\n                    lg: 12,\n                    xl: 12,\n                    children: [/*#__PURE__*/_jsx(Form.Item, {\n                      name: \"target_person_type\",\n                      label: \"Tipo de persona\",\n                      labelCol: {\n                        span: 10\n                      },\n                      children: /*#__PURE__*/_jsx(Select, {\n                        options: personType\n                      }, \"person_select\")\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"target_gender\",\n                      label: \"G\\xE9nero\",\n                      labelCol: {\n                        span: 10\n                      },\n                      children: /*#__PURE__*/_jsx(Select, {\n                        options: genders\n                      }, \"gender_select\")\n                    })]\n                  })]\n                })\n              }), /*#__PURE__*/_jsxs(Col, {\n                span: 24,\n                style: {\n                  textAlign: \"right\"\n                },\n                children: [/*#__PURE__*/_jsx(Button, {\n                  onClick: function onClick() {\n                    return onCancel();\n                  },\n                  disabled: sending,\n                  style: {\n                    padding: \"0 50px\",\n                    margin: \"0 10px\"\n                  },\n                  children: \"Cancelar\"\n                }, \"cancel\"), /*#__PURE__*/_jsx(Button, {\n                  htmlType: \"submit\",\n                  loading: sending,\n                  type: \"primary\",\n                  style: {\n                    padding: \"0 50px\",\n                    margin: \"0 10px\"\n                  },\n                  children: \"Enviar\"\n                }, \"save\")]\n              })]\n            })\n          }, \"notification_form\")\n        })\n      })\n    })]\n  });\n};\n\nexport default Newrelease;","map":null,"metadata":{},"sourceType":"module"}