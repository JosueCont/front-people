{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { Form, Modal, message, Layout, Select, Upload, Button, Space } from \"antd\";\nimport TextArea from \"antd/lib/input/TextArea\";\nimport { useCallback, useEffect, useState, useRef } from \"react\";\nimport { UploadOutlined, CloudUploadOutlined, CloseCircleOutlined } from \"@ant-design/icons\";\nimport Axios from \"axios\";\nimport { API_URL } from \"../../config/config\";\n\nvar documentModal = function documentModal(props) {\n  var _Form$useForm = Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var _useState = useState(),\n      file = _useState[0],\n      setFile = _useState[1];\n\n  var _useState2 = useState(true),\n      disabled = _useState2[0],\n      setDisabled = _useState2[1];\n\n  var _useState3 = useState([]),\n      documentType = _useState3[0],\n      setDocumentType = _useState3[1];\n\n  var inputFileRef = useRef(null);\n\n  var _useState4 = useState(\"\"),\n      fileName = _useState4[0],\n      setfileName = _useState4[1];\n\n  var closeDialog = function closeDialog() {\n    props.close(false);\n    form.resetFields();\n  };\n\n  useEffect(function () {\n    Axios.get(API_URL + \"/setup/document-type/\").then(function (response) {\n      var dt = response.data.results;\n      dt = dt.map(function (a) {\n        return {\n          label: a.name,\n          value: a.id\n        };\n      });\n      setDocumentType(dt);\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  }, []);\n\n  var selectedFile = function selectedFile(file) {\n    if (file.target.files.length > 0) {\n      setDisabled(false);\n      setFile(file.target.files[0]);\n      setfileName(file.target.files[0].name);\n    } else {\n      setDisabled(true);\n      setFile(null);\n      setfileName(null);\n    }\n  };\n\n  var onFinish = function onFinish(value) {\n    var data = new FormData();\n    data.append(\"document\", file);\n    data.append(\"person\", props.person);\n    data.append(\"document_type\", value.document_type);\n    data.append(\"description\", value.description);\n    uploadDocument(data);\n  };\n\n  var uploadDocument = function uploadDocument(data) {\n    Axios.post(API_URL + \"/person/document/\", data).then(function (response) {\n      message.success({\n        content: \"Cargado correctamente.\",\n        className: \"custom-class\"\n      });\n      closeDialog();\n    })[\"catch\"](function (e) {\n      console.log(e);\n    });\n  };\n\n  var deleteFileSelect = function deleteFileSelect() {\n    setFile(null);\n    setDisabled(true);\n    setfileName(null);\n  };\n\n  var ruleRequired = {\n    required: true,\n    message: \"Este campo es requerido\"\n  };\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsx(Layout, {\n      children: /*#__PURE__*/_jsx(Modal, {\n        maskClosable: false,\n        title: \"Subir documemnto\",\n        centered: true,\n        visible: props.visible,\n        onCancel: function onCancel() {\n          return closeDialog();\n        },\n        footer: null,\n        children: /*#__PURE__*/_jsxs(Form, {\n          onFinish: onFinish,\n          form: form,\n          children: [/*#__PURE__*/_jsx(Form.Item, {\n            name: \"document_type\",\n            rules: [ruleRequired],\n            children: /*#__PURE__*/_jsx(Select, {\n              options: documentType,\n              placeholder: \"Tipo de documento\"\n            })\n          }), /*#__PURE__*/_jsxs(Form.Item, {\n            children: [/*#__PURE__*/_jsx(Button, {\n              onClick: function onClick() {\n                inputFileRef.current.click();\n              },\n              icon: /*#__PURE__*/_jsx(UploadOutlined, {}),\n              children: \"Cargar documento\"\n            }), disabled ? \"\" : /*#__PURE__*/_jsxs(\"span\", {\n              style: {\n                marginLeft: 8,\n                border: \"1px blue solid\"\n              },\n              children: [fileName + \"  \", /*#__PURE__*/_jsx(CloseCircleOutlined, {\n                onClick: function onClick() {\n                  return deleteFileSelect();\n                },\n                style: {\n                  color: \"red\"\n                }\n              })]\n            }), /*#__PURE__*/_jsx(\"input\", {\n              ref: inputFileRef,\n              type: \"file\",\n              style: {\n                display: \"none\"\n              },\n              onChange: function onChange(e) {\n                return selectedFile(e);\n              }\n            })]\n          }), /*#__PURE__*/_jsx(Form.Item, {\n            name: \"description\",\n            rules: [ruleRequired],\n            children: /*#__PURE__*/_jsx(TextArea, {\n              type: \"text\",\n              placeholder: \"Descripci\\xF3n\"\n            })\n          }), /*#__PURE__*/_jsx(Form.Item, {\n            labelAlign: \"right\",\n            children: /*#__PURE__*/_jsxs(Space, {\n              style: {\n                \"float\": \"right\"\n              },\n              children: [/*#__PURE__*/_jsx(Button, {\n                type: \"danger\",\n                onClick: function onClick() {\n                  return closeDialog();\n                },\n                children: \"Cancelar\"\n              }), /*#__PURE__*/_jsx(Button, {\n                disabled: disabled,\n                icon: /*#__PURE__*/_jsx(CloudUploadOutlined, {}),\n                type: \"primary\",\n                htmlType: \"submit\",\n                children: \"Subir\"\n              })]\n            })\n          })]\n        })\n      })\n    })\n  });\n};\n\nexport default documentModal;","map":null,"metadata":{},"sourceType":"module"}